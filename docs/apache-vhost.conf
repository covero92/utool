# Apache Virtual Host Configuration for Utool Hub
# Save to: /etc/apache2/sites-available/utool.conf

<VirtualHost *:80>
    ServerName utool.intelidata.local
    ServerAlias utool.local
    DocumentRoot /var/www/html/utool
    
    <Directory /var/www/html/utool>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
        
        # PHP Configuration
        <FilesMatch \.php$>
            SetHandler "proxy:unix:/var/run/php/php8.0-fpm.sock|fcgi://localhost"
        </FilesMatch>
        
        # Security Headers
        Header always set X-Frame-Options "SAMEORIGIN"
        Header always set X-Content-Type-Options "nosniff"
        Header always set X-XSS-Protection "1; mode=block"
    </Directory>
    
    # Deny access to sensitive files
    <FilesMatch "^\.">
        Require all denied
    </FilesMatch>
    
    <FilesMatch "\.env$">
        Require all denied
    </FilesMatch>
    
    # Logging
    ErrorLog ${APACHE_LOG_DIR}/utool-error.log
    CustomLog ${APACHE_LOG_DIR}/utool-access.log combined
    
    # Optional: Enable compression
    <IfModule mod_deflate.c>
        AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript
    </IfModule>
</VirtualHost>

# To enable this site:
# sudo a2ensite utool.conf
# sudo a2enmod rewrite proxy_fcgi headers deflate
# sudo systemctl reload apache2
